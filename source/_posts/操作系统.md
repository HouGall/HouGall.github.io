## 内存管理

> 内存管理就是对内存进行分配和收回，同时将逻辑地址和物理地址进行转换。

### 内存管理方式
>1.连续内存管理方式：
>>块式管理：将内存分成大小相同的块，每个进程占一个块进行执行。
>2.非连续内存管理：
>>1.页式管理：将内存分成比块小的大小相同的页，提高了内存利用率，减小了碎片，通过页表进行逻辑地址和物理地址的转换。页式管理的页没有实际意义。页内连续，页之间离散。
>>2.段式管理：根据程序段和数据段将逻辑地址分成大小不同的段。通过段表进行转换。每个段定义了一组逻辑信息，例如,有主程序段 MAIN、子程序段 X、数据段 D 及栈段 S 等。段有实际意义。段内连续，段之间离散。
>>3.段页式管理：首先是根据程序段和数据段将内存分成段，在段里将段分为页。段页式结合了段和页，使之拥有段和页的优点。段之间离散，段内的页也离散。

### 为解决内存管理中的两个重要问题，使用了快表和多级页表。
>两个重要问题：
>>1.逻辑地址和物理地址之间的转化慢。
>>2.对于逻辑地址大的页表也很大，搜索慢。
>1.采用快表解决转化慢的问题，快表可以理解为一个缓存器，它将页表中的部分内容或者全部内容放到catch中，加快访问速度。有了快表，如果快表中有需要的页地址，只需要访问一次内存，而没有快表的话需要访问两次。
>2.对于页表过大问题，采用多级页表，一级页表存储多个二级页表的地址，二级存三级。。相当于一个多叉树。

### 有快表的地址转化：
>1.在快表中查询相应的页地址，如果有的话就只直接进行转化并访问物理地址。
>2.如果没有，需要到内存的页表进行查询，查询到页后对物理地址数据进行访问，并将此页表中的此页地址映射加入到快表中。
>3.当快表满了后，需要使用一些置换算法将旧的页置换出去，加入新的页。

### 页置换算法
>1.先进先出置换算法。
>2.最佳置换算法。（理论上）
>3.最近最久未使用置换算法。
>4.最少使用置换算法。（使用次数最少的页换出去）

### 逻辑地址和物理地址
>逻辑地址是操作系统分配的，方便管理内存。编程遇到的都是逻辑地址。
>物理地址是硬件中的真实地址，确切的说就是内存地址寄存器中的真实地址。

### CPU寻址
>CPU寻址就是将虚拟地址（逻辑地址）转为物理地址。
>用虚拟地址的原因是：
>1.方便操作系统对内存进行管理和分配。
>2.如果没有虚拟内存，那么每个程序都能对相同的物理地址数据进行访问和修改，会破坏操作系统，造成系统奔溃。
>3.如果有了虚拟地址，程序可以访问虚拟地址连续，但是物理地址不连续的空间，提高了利用率。
>4.程序可以通过虚拟内存使用大于物理内存的内存缓冲区。
>5.不同的进程通过相互隔离的逻辑地址，访问不同的物理地址。

### 虚拟内存
>虚拟内存是操作系统为了方便系统管理和减少内存出错，定义的连续的虚拟地址。
>虚拟内存为每个程序都分配了单独的虚拟地址块，使程序产生一种独享内存的错觉；
>同时虚拟内存还可以保护每个进程的物理内存不被其他的进程破坏；
>并且，对于超出物理内存的程序也可以进行处理，就是将某个进程的内存先放到硬盘空间中，等到用到这个进程的时候再将此进程调到内存中。

### 局部性原理
>局部性原理使虚拟内存的基础。
>有以下两个方面：
>1.时间局部性：程序在某个时间执行了一个指令，在短时间内还可能再次执行；在某个时间访问了一块数据，在短时间内可能还会访问，这是由于程序存在大量的循环结构。
>2.空间局部性：程序在一段时间内访问的地址可能都是集中在一定范围内，这是由于程序中使用的数据结构大多是数组，链表等连续性结构。
>
>##### 虚拟内存技术实际上就是建立了 “内存一外存”的两级存储器的结构，利用局部性原理实现髙速缓存。
>根据局部性原理，可以将程序的一部分先装入内存进行运行，另一部分可以先放在硬盘，进行调用。所以程序使用的内存可以比实际内存大。
### 虚拟内存的实现
>待更新。。。

###  

